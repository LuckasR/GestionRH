<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{fragment/template1}">
<body>
<div layout:fragment="content">
<div class="card">
<h5 class='card-header'>üîî Notifications & Alertes Automatiques</h5>
<div class="card-body">
<p class="text-muted mb-4">
    <strong>Syst√®me d'alertes automatiques activ√© :</strong><br>
    ‚Ä¢ Alertes pour cong√©s en attente depuis plus de 3 jours<br>
    ‚Ä¢ Alertes pour absences r√©p√©t√©es (3+ absences en 30 jours)<br>
    ‚Ä¢ Notifications par email et interface utilisateur<br>
    ‚Ä¢ T√¢che programm√©e : ex√©cution quotidienne √† 9h00
</p>

<h6>Notifications r√©centes</h6>
<div class="table-responsive">
<table class="table table-hover">
<thead class="table-light">
<tr>
<th>ID</th>
<th>Employ√©</th>
<th>Type</th>
<th>Message</th>
<th>Lu</th>
<th>Date cr√©ation</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
<tr th:each='row : ${notifications}' th:class="${row.est_lu ? '' : 'table-warning'}">
<td th:text='${row.id}'></td>
<td>
    <span th:if="${row.employee != null}" th:text='${row.employee.username}'></span>
    <span th:if="${row.employee == null}" class="text-muted">Syst√®me</span>
</td>
<td>
    <span th:if="${row.type_notification != null}" th:text='${row.type_notification.nom}'></span>
    <span th:if="${row.type_notification == null}" class="text-muted">G√©n√©ral</span>
</td>
<td>
    <strong th:if="${!row.est_lu}" th:text='${row.message}'></strong>
    <span th:if="${row.est_lu}" th:text='${row.message}'></span>
</td>
<td>
    <span th:if="${row.est_lu}" class="badge bg-success">Lu</span>
    <span th:if="${!row.est_lu}" class="badge bg-warning">Non lu</span>
</td>
<td th:text='${#temporals.format(row.date_creation, "dd/MM/yyyy HH:mm")}'></td>
<td>
    <a th:href='@{/notification/edit/{id}(id=${row.id})}' class="btn btn-sm btn-outline-primary">Modifier</a>
    <a th:href='@{/notification/delete/{id}(id=${row.id})}' class="btn btn-sm btn-outline-danger ms-1"
       onclick="return confirm('Confirmer la suppression ?')">Supprimer</a>
</td>
</tr>
<tr th:if="${#lists.isEmpty(notifications)}">
    <td colspan="7" class="text-center text-muted py-4">
        <i class="bx bx-bell-off bx-lg mb-2"></i><br>
        Aucune notification pour le moment
    </td>
</tr>
</tbody>
</table>
</div>

<div class="mt-3">
    <a th:href='@{/notification/create}' class="btn btn-primary">
        <i class="bx bx-plus"></i> Cr√©er une notification
    </a>
</div>
</div>
</div>
</div>
</body>
</html>
